# NumPy è¯­æ³•ç¬”è®°
## 1. åŸºæœ¬æ¦‚å¿µ
### ä»€ä¹ˆæ˜¯ NumPyï¼Ÿ
- **NumPyï¼ˆNumerical Pythonï¼‰**Â æ˜¯ Python ç§‘å­¦è®¡ç®—ç”Ÿæ€çš„åŸºçŸ³åº“ã€‚
- æ ¸å¿ƒæ˜¯Â `ndarray`ï¼ˆn-dimensional arrayï¼‰ï¼Œå³å¤šç»´æ•°ç»„å¯¹è±¡ï¼Œç›¸æ¯” Python åŸç”Ÿåˆ—è¡¨ï¼š
    - æ›´é«˜æ•ˆï¼šåº•å±‚ç”¨ C å®ç°ï¼Œå†…å­˜è¿ç»­ï¼›
    - æ”¯æŒå‘é‡åŒ–è¿ç®—ï¼ˆæ— éœ€å¾ªç¯ï¼‰ï¼›
    - æä¾›ä¸°å¯Œçš„æ•°å­¦å‡½æ•°å’Œçº¿æ€§ä»£æ•°æ“ä½œã€‚
### æ•°ç»„ç»´åº¦ï¼ˆAxisï¼‰
- **axis=0**ï¼šçºµå‘ â†’ è¡Œæ–¹å‘ï¼ˆå‚ç›´ï¼‰
- **axis=1**ï¼šæ¨ªå‘ â†’ åˆ—æ–¹å‘ï¼ˆæ°´å¹³ï¼‰
- **axis=2+**ï¼šæ›´é«˜ç»´å¼ é‡ï¼ˆå¦‚å›¾åƒé€šé“ã€æ—¶é—´åºåˆ—ç­‰ï¼‰

| ç»´åº¦  | åç§°  | ç¤ºä¾‹å½¢çŠ¶        | å¯è§†åŒ–               |
| --- | --- | ----------- | ----------------- |
| 0D  | æ ‡é‡  | `()`        | å•ä¸ªæ•°å­—              |
| 1D  | å‘é‡  | `(5,)`      | `[1, 2, 3, 4, 5]` |
| 2D  | çŸ©é˜µ  | `(3, 4)`    | è¡¨æ ¼                |
| 3D  | å¼ é‡  | `(2, 3, 4)` | å¤šå±‚çŸ©é˜µå †å             |

ğŸ“Œ æ³¨æ„ï¼š`(5,)` å’Œ `(5,1)` ä¸åŒ â€”â€” å‰è€…æ˜¯ä¸€ç»´å‘é‡ï¼Œåè€…æ˜¯äºŒç»´åˆ—å‘é‡ï¼
## 2. åˆ›å»ºæ•°ç»„
### åŸºç¡€åˆ›å»ºæ–¹æ³•
#### `np.array()`
ä» Python åˆ—è¡¨/å…ƒç»„æ„é€ æ•°ç»„ï¼š
```python
a = np.array([1, 2, 3])           # ä¸€ç»´
b = np.array([[1,2], [3,4]])      # äºŒç»´
c = np.array([, )      # ä¸‰ç»´ (2,1,1)
```
ğŸ“Œ è‡ªåŠ¨æ¨æ–­ `dtype`ï¼›å¯æŒ‡å®š ` dtype = np.float64 ` ç­‰ã€‚

#### å…¨é›¶ / å…¨ä¸€ / å•ä½çŸ©é˜µ
```python
zeros = np.zeros((2, 3))                # float64 ç±»å‹
ones = np.ones((3, 3), dtype=int)       # æŒ‡å®šæ•´å‹
eye = np.eye(3)                         # 3x3 å•ä½çŸ©é˜µ
identity = np.identity(3)               # åŒ eye()
full = np.full((2, 4), 7)               # æ‰€æœ‰å…ƒç´ ä¸º 7
```

#### åºåˆ—ç”Ÿæˆå™¨
```python
arange = np.arange(0, 10, 2)            # [0, 2, 4, 6, 8]
linspace = np.linspace(0, 1, 5)         # [0. , 0.25, 0.5 , 0.75, 1. ]
logspace = np.logspace(0, 2, 5)         # å¯¹æ•°ç­‰è·: 10^0 ~ 10^2 åˆ†5æ®µ
geomspace = np.geomspace(1, 1000, 4)    # å‡ ä½•ç­‰æ¯”: 1, 10, 100, 1000
```

#### éšæœºæ•°ç»„
```python
rand = np.random.rand(2, 3)             # [0,1) å‡åŒ€åˆ†å¸ƒ
randn = np.random.randn(2, 3)           # æ ‡å‡†æ­£æ€åˆ†å¸ƒ Î¼=0, Ïƒ=1
randint = np.random.randint(0, 10, size=(3,3))  # æ•´æ•°éšæœº [0,10)
random_sample = np.random.random((2,2)) # åŒ rand()
choice = np.random.choice([1,2,3,4], size=5)   # ä»ç»™å®šé›†åˆæŠ½æ ·
shuffle = np.random.permutation(10)     # æ‰“ä¹± 0~9
```
#### ç‰¹æ®Šç»“æ„æ•°ç»„
```python
diag = np.diag([1,2,3])                 # å¯¹è§’çŸ©é˜µ
tri = np.tri(3)                         # ä¸‹ä¸‰è§’çŸ©é˜µ
tril = np.tril([[1,2,3],[4,5,6],[7,8,9]]) # å–ä¸‹ä¸‰è§’éƒ¨åˆ†
triu = np.triu(...)                     # ä¸Šä¸‰è§’
meshgrid = np.meshgrid([1,2], [3,4])    # ç½‘æ ¼åæ ‡ï¼ˆç”¨äºç»˜å›¾ï¼‰
```
## 3. æ•°ç»„å±æ€§è¯¦è§£
```python
arr = np.array([[1., 2., 3.],
                [4., 5., 6.]])

print("Shape:", arr.shape)     # (2, 3)
print("NDim:", arr.ndim)       # 2
print("Size:", arr.size)       # 6
print("Dtype:", arr.dtype)     # float64
print("Itemsize:", arr.itemsize) # å­—èŠ‚å¤§å°ï¼Œfloat64=8
print("Strides:", arr.strides) # å†…å­˜æ­¥é•¿ (24, 8) â†’ è¡Œè·³24å­—èŠ‚ï¼Œåˆ—è·³8å­—èŠ‚
print("Flags:", arr.flags)     # å†…å­˜å¸ƒå±€ä¿¡æ¯ï¼ˆæ˜¯å¦è¿ç»­ç­‰ï¼‰
print("Data:", arr.data)       # å†…å­˜ç¼“å†²åŒºåœ°å€ï¼ˆä¸å¸¸ç”¨ï¼‰
```

ğŸ“Œ **é‡è¦æ¦‚å¿µï¼šå†…å­˜è¿ç»­æ€§**
- C_CONTIGUOUSï¼šè¡Œä¼˜å…ˆå­˜å‚¨ï¼ˆé»˜è®¤ï¼‰
- F_CONTIGUOUSï¼šåˆ—ä¼˜å…ˆå­˜å‚¨ï¼ˆFortrané£æ ¼ï¼‰
å¯ç”¨ `.copy(order='F')` è½¬æ¢ã€‚
## 4. ç´¢å¼•ä¸åˆ‡ç‰‡ï¼ˆè¶…è¯¦ç»†ï¼‰
### åŸºç¡€ç´¢å¼•
```python
arr = np.array([[1, 2, 3],
                [4, 5, 6],
                [7, 8, 9]])

arr[0, 1]     # 2
arr[1][2]     # 6 ï¼ˆç­‰ä»·å†™æ³•ï¼Œä½†æ•ˆç‡ç•¥ä½ï¼‰
arr[-1, -1]   # 9 ï¼ˆè´Ÿç´¢å¼•æ”¯æŒï¼‰
```

### åˆ‡ç‰‡ï¼ˆSliceï¼‰
```python
arr[0:2, 1:3]     # [[2,3], [5,6]]
arr[:, ::-1]      # æ¯è¡Œåè½¬ â†’ [[3,2,1], [6,5,4], [9,8,7]]
arr[::2, :]       # éš”è¡Œå– â†’ ç¬¬0ã€2è¡Œ
arr[1, 1:]        # [5,6]
```

ğŸ“Œ åˆ‡ç‰‡è¿”å›çš„æ˜¯**åŸæ•°ç»„çš„è§†å›¾ï¼ˆViewï¼‰**ï¼Œä¿®æ”¹ä¼šå½±å“åŸæ•°ç»„ï¼
```python
sub = arr[0:2, 0:2]
sub[0,0] = 999
print(arr[0,0])  # è¾“å‡º 999ï¼å› ä¸ºæ˜¯ View
```

âœ… å¦‚éœ€å‰¯æœ¬ â†’ ä½¿ç”¨ `.copy()`
```python
safe_copy = arr[0:2, 0:2].copy()
```

### æ¡ä»¶ç´¢å¼•ï¼ˆBoolean Indexingï¼‰
```python
mask = arr > 5
print(mask)
# [[False False False]
#  [False False  True]
#  [ True  True  True]]

arr[mask]        # [6 7 8 9] â†’ è¿”å›æ»¡è¶³æ¡ä»¶çš„ä¸€ç»´æ•°ç»„
arr[arr % 2 == 0] # [2 4 6 8] â†’ å¶æ•°

# å¤šæ¡ä»¶ç»„åˆ
arr[(arr > 3) & (arr < 8)]  # [4 5 6 7]
```

âš ï¸ æ³¨æ„ï¼šå¿…é¡»ç”¨ `&`, `|`, `~`ï¼Œä¸èƒ½ç”¨ `and`, `or`, `not`

### èŠ±å¼ç´¢å¼•ï¼ˆFancy Indexingï¼‰
ä½¿ç”¨æ•´æ•°æ•°ç»„æˆ–åˆ—è¡¨ç´¢å¼•ï¼š
```python
rows = np.array([0, 2])
cols = np.array([1, 2])
arr[rows, cols]  # [arr[0,1], arr[2,2]] â†’ [2, 9]

# æˆ–è€…å…ˆé€‰è¡Œå†é€‰åˆ—
arr[[0,2]][:, [1,2]]  # [[2,3], [8,9]]
```

ğŸ“Œ èŠ±å¼ç´¢å¼•æ€»æ˜¯è¿”å›**å‰¯æœ¬**
## 5. æ•°ç»„è¿ç®—ï¼ˆå¹¿æ’­æœºåˆ¶ï¼‰

### åŸºæœ¬ç®—æœ¯è¿ç®—
```python
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])

a + b   # [5 7 9]
a * b   # [4 10 18]
a ** 2  # [1 4 9]
a / b   # [0.25 0.4  0.5 ]
a // b  # [0 0 0] æ•´é™¤
a % b   # [1 2 3] å–ä½™
```

æ”¯æŒä¸**æ ‡é‡**è¿ç®—ï¼š
```python
a + 10   # [11 12 13]
a * 2.5  # [2.5 5.  7.5]
```

### æ•°å­¦å‡½æ•°
```python
np.sin(a)     # æ­£å¼¦
np.cos(a)     # ä½™å¼¦
np.exp(a)     # e^x
np.log(a)     # è‡ªç„¶å¯¹æ•° ln(x)
np.log10(a)   # log10
np.sqrt(a)    # å¹³æ–¹æ ¹
np.abs(a)     # ç»å¯¹å€¼
np.ceil(a)    # å‘ä¸Šå–æ•´
np.floor(a)   # å‘ä¸‹å–æ•´
np.round(a)   # å››èˆäº”å…¥
np.clip(a, 1, 2)  # æˆªæ–­åˆ° [1,2] åŒºé—´
```

### å¹¿æ’­æœºåˆ¶ï¼ˆBroadcastingï¼‰
å½“ä¸¤ä¸ªæ•°ç»„ shape ä¸åŒæ—¶ï¼ŒNumPy ä¼šå°è¯•â€œå¹¿æ’­â€ä½¿å®ƒä»¬å…¼å®¹ã€‚
#### å¹¿æ’­è§„åˆ™ï¼š
1. ä»åå¾€å‰å¯¹é½ç»´åº¦ï¼›
2. æ¯ä¸ªç»´åº¦è¦ä¹ˆç›¸ç­‰ï¼Œè¦ä¹ˆå…¶ä¸­ä¸€ä¸ªä¸º 1ï¼›
3. æœ€ç»ˆ shape å–å„ç»´åº¦æœ€å¤§å€¼ã€‚
#### ç¤ºä¾‹ï¼š
```python
A = np.ones((3, 4))        # shape (3,4)
B = np.array([1, 2, 3, 4]) # shape (4,) â†’ è‡ªåŠ¨æ‰©å±•ä¸º (1,4)

C = A + B  # shape (3,4)
# B è¢«å¹¿æ’­æˆï¼š
# [[1,2,3,4],
#  [1,2,3,4],
#  [1,2,3,4]]
```

#### ä¸åˆæ³•å¹¿æ’­ï¼š
```python
A = np.ones((3, 2))
B = np.ones((3,))     # shape (3,) â†’ æ— æ³•å¯¹é½åˆ° (3,2)ï¼Œå› ä¸º 3â‰ 2 ä¸”æ— 1
# æŠ¥é”™ï¼
```

âœ… è§£å†³æ–¹æ¡ˆï¼šæ‰‹åŠ¨ reshape
```python
B = B.reshape(3, 1)   # shape (3,1) â†’ å¯å¹¿æ’­åˆ° (3,2)
```

ğŸ“Œ å¹¿æ’­éå¸¸å¼ºå¤§ï¼Œé¿å…**æ˜¾å¼å¾ªç¯**ï¼
## 6. å¸¸ç”¨å‡½æ•°å¤§å…¨
### ç»Ÿè®¡å‡½æ•°ï¼ˆå¯æŒ‡å®š axisï¼‰
```python
arr = np.array([[1, 2, 3],
                [4, 5, 6]])

arr.sum()           # æ€»å’Œ 21
arr.sum(axis=0)     # æŒ‰åˆ—æ±‚å’Œ â†’ [5,7,9]
arr.sum(axis=1)     # æŒ‰è¡Œæ±‚å’Œ â†’ [6,15]

arr.mean()          # 3.5
arr.mean(axis=1)    # [2., 5.]

arr.max(), arr.min()
arr.argmax()        # æœ€å¤§å€¼ç´¢å¼•ï¼ˆå±•å¹³åï¼‰â†’ 5
arr.argmax(axis=0)  # æ¯åˆ—æœ€å¤§å€¼æ‰€åœ¨è¡Œå· â†’ [1,1,1]
arr.argmin(axis=1)  # æ¯è¡Œæœ€å°å€¼æ‰€åœ¨åˆ—å· â†’ [0,0]

arr.std()           # æ ‡å‡†å·®
arr.var()           # æ–¹å·®
np.median(arr)      # ä¸­ä½æ•°
np.percentile(arr, 50) # 50%åˆ†ä½æ•°ï¼ˆä¸­ä½æ•°ï¼‰
```

ğŸ“Œ `keepdims=True` ä¿ç•™ç»´åº¦ï¼š
```python
arr.sum(axis=1, keepdims=True)  # shape (2,1) è€Œé (2,)
```
### çŸ©é˜µè¿ç®—
```python
A = np.array([[1, 2],
              [3, 4]])
B = np.array([[2, 0],
              [1, 3]])

# çŸ©é˜µä¹˜æ³•
np.dot(A, B)        # æ¨è
A @ B               # Python 3.5+ æ–°è¯­æ³•ï¼Œæ›´ç®€æ´
np.matmul(A, B)     # åŒ @ï¼Œæ¨èç”¨äºé«˜ç»´

# è½¬ç½®
A.T
A.transpose()       # å¯æŒ‡å®šè½´é¡ºåºï¼Œå¦‚ transpose(1,0)

# é€†çŸ©é˜µ & è¡Œåˆ—å¼
inv_A = np.linalg.inv(A)
det_A = np.linalg.det(A)

# ç‰¹å¾å€¼åˆ†è§£
eigenvals, eigenvecs = np.linalg.eig(A)

# SVD å¥‡å¼‚å€¼åˆ†è§£
U, S, Vt = np.linalg.svd(A)

# è§£çº¿æ€§æ–¹ç¨‹ Ax = b
b = np.array([1, 2])
x = np.linalg.solve(A, b)
```

ğŸ“Œ æ³¨æ„ï¼š`*` æ˜¯é€å…ƒç´ ä¹˜æ³•ï¼Œ`@` æˆ– `dot` æ˜¯çŸ©é˜µä¹˜æ³•ï¼
## 7. æ•°ç»„å˜å½¢ä¸æ‹¼æ¥ï¼ˆReshape & Concatenateï¼‰
### å½¢çŠ¶å˜æ¢
```python
a = np.arange(12)  # [0,1,...,11]

a.reshape(3, 4)        # å˜æˆ 3x4
a.reshape(3, -1)       # -1 è‡ªåŠ¨æ¨æ–­ â†’ 3x4
a.reshape(-1, 1)       # åˆ—å‘é‡ (12,1)

a.ravel()              # å±•å¹³ â†’ [0,1,...,11]ï¼Œè¿”å›è§†å›¾
a.flatten()            # å±•å¹³ï¼Œè¿”å›å‰¯æœ¬

a.T                    # è½¬ç½®ï¼ˆå¯¹1Dæ— æ•ˆï¼‰
a[np.newaxis, :]       # å¢åŠ æ–°è½´ â†’ shape (1,12)
a[:, np.newaxis]       # shape (12,1)

# äº¤æ¢è½´
np.swapaxes(a.reshape(3,4), 0, 1)  # è½¬ç½®
np.moveaxis(a.reshape(2,3,2), 0, -1) # ç§»åŠ¨è½´
```

### æ‹¼æ¥æ•°ç»„
```python
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])

np.vstack([a, b])      # å‚ç›´å †å  â†’ shape (2,3)
np.hstack([a, b])      # æ°´å¹³å †å  â†’ shape (6,)
np.column_stack([a, b]) # åˆ—å †å  â†’ shape (3,2) [[1,4],[2,5],[3,6]]

# é€šç”¨æ‹¼æ¥
np.concatenate([a, b])           # é»˜è®¤ axis=0 â†’ [1,2,3,4,5,6]
np.concatenate([[a], [b]], axis=0) # åŒ vstack

# æ‹†åˆ†
np.split(a, [2])       # åœ¨ç´¢å¼•2å¤„åˆ†å‰² â†’ [[1,2], [3]]
np.hsplit(arr, 2)      # æ°´å¹³åˆ†å‰²
np.vsplit(arr, 2)      # å‚ç›´åˆ†å‰²
```
## 8. ä¿å­˜ä¸åŠ è½½æ•°æ®
### äºŒè¿›åˆ¶æ ¼å¼ï¼ˆæ¨èï¼Œé«˜æ•ˆï¼‰
```python
a = np.arange(10)

np.save('data.npy', a)              # ä¿å­˜å•ä¸ªæ•°ç»„
loaded = np.load('data.npy')        # åŠ è½½

# ä¿å­˜å¤šä¸ªæ•°ç»„
np.savez('data.npz', arr1=a, arr2=a*2)
data = np.load('data.npz')
print(data['arr1'], data['arr2'])

# å‹ç¼©ç‰ˆæœ¬
np.savez_compressed('data_compressed.npz', a=a, b=b)
```

### æ–‡æœ¬æ ¼å¼ï¼ˆä¾¿äºæŸ¥çœ‹/å…±äº«ï¼‰
```python
np.savetxt('data.txt', a, fmt='%d')     # fmt æ§åˆ¶æ ¼å¼
loaded_txt = np.loadtxt('data.txt', dtype=int)

# CSV æ ¼å¼ä¹Ÿé€‚ç”¨
np.savetxt('data.csv', arr_2d, delimiter=',')
loaded_csv = np.loadtxt('data.csv', delimiter=',')
```

ğŸ“Œ å¯¹äºå¤§å‹æ•°æ®æˆ–ç»“æ„åŒ–æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨ `pandas` æˆ– `h5py`ã€‚
## 9. å®ç”¨æŠ€å·§ & æ³¨æ„äº‹é¡¹
### è§†å›¾ vs å‰¯æœ¬
```python
a = np.array([1,2,3])
b = a           # å¼•ç”¨ â†’ ä¿®æ”¹ b ä¼šæ”¹ a
c = a[:]        # åˆ‡ç‰‡ â†’ è§†å›¾ â†’ ä¿®æ”¹ c ä¼šæ”¹ a
d = a.copy()    # å‰¯æœ¬ â†’ å®‰å…¨
```

âœ… ä½¿ç”¨ `.base` åˆ¤æ–­æ˜¯å¦å…±äº«å†…å­˜ï¼š
```python
print(c.base is a)  # True â†’ æ˜¯è§†å›¾
print(d.base is a)  # False â†’ æ˜¯å‰¯æœ¬
```

### å°±åœ°æ“ä½œï¼ˆèŠ‚çœå†…å­˜ï¼‰
```python
a += 1     # å°±åœ°åŠ ï¼Œä¸åˆ›å»ºæ–°æ•°ç»„
a *= 2
np.add(a, 1, out=a)  # æ˜¾å¼æŒ‡å®šè¾“å‡ºä½ç½®
```

### æ•°æ®ç±»å‹è½¬æ¢
```python
a = np.array([1,2,3], dtype=np.int32)
b = a.astype(np.float64)   # è½¬æ¢ç±»å‹ï¼Œè¿”å›å‰¯æœ¬
a.dtype = np.float64       # âŒ é”™è¯¯ï¼ä¼šè§£é‡Šå†…å­˜ä¸º floatï¼Œå¯¼è‡´æ•°æ®é”™ä¹±ï¼
```

âœ… æ­£ç¡®æ–¹å¼æ°¸è¿œæ˜¯ `.astype()`

### å†…å­˜ä¼˜åŒ–æŠ€å·§
```python
# åˆ›å»ºæ—¶æŒ‡å®š dtype èŠ‚çœå†…å­˜
a = np.zeros(1000000, dtype=np.float32)  # è€Œéé»˜è®¤ float64

# ä½¿ç”¨ np.memmap å¤„ç†è¶…å¤§æ–‡ä»¶ï¼ˆå†…å­˜æ˜ å°„ï¼‰
fp =
```